<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Memory Game ‚ù§Ô∏è</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:linear-gradient(#ffe6f0,#fff);
  text-align:center;
}
h1{color:#ff4d88}
.grid{
  display:grid;
  grid-template-columns:repeat(4,80px);
  gap:12px;
  justify-content:center;
}
.card{
  width:80px;
  height:80px;
  perspective:600px;
}
.inner{
  width:100%;
  height:100%;
  position:relative;
  transform-style:preserve-3d;
  transition:0.4s;
}
.open .inner{transform:rotateY(180deg)}
.face{
  position:absolute;
  width:100%;
  height:100%;
  backface-visibility:hidden;
  border-radius:16px;
}
.front{background:#ff4d88}
.back{
  transform:rotateY(180deg);
  background-size:cover;
  background-position:center;
}
button{
  margin:10px;
  padding:10px 18px;
  border:none;
  border-radius:25px;
  background:#ff4d88;
  color:white;
}
</style>
</head>

<body>

<h1>üíñ Memory Match</h1>
<p>Flips: <span id="flips">0</span> | Best: <span id="best">0</span></p>

<div class="grid" id="grid"></div>

<button onclick="resetGame()">üîÑ Play Again</button>
<button onclick="goHome()">‚¨Ö Back</button>
<button onclick="toggleMute()">üîà</button>

<audio id="music" src="music1.mp3"></audio>

<script>
/* RESET BEST SCORE EVERY TIME */
localStorage.setItem("best","0");

const images=["img1.jpg","img2.jpg","img3.jpg","img4.jpg","img5.jpg","img6.jpg"];
let cards=[],first=null,lock=false,matched=0,flips=0;

const grid=document.getElementById("grid");
const flipsEl=document.getElementById("flips");
const bestEl=document.getElementById("best");
const music=document.getElementById("music");

bestEl.textContent=0;

/* music restore */
music.currentTime = Number(localStorage.getItem("musicTime")||0);
music.play();

music.onended=()=>{
  music.src = music.src.includes("music1") ? "music2.mp3" : "music1.mp3";
  music.play();
};

function toggleMute(){music.muted=!music.muted}

/* game */
function start(){
  grid.innerHTML="";
  cards=[...images,...images].sort(()=>Math.random()-0.5);
  first=null;lock=false;matched=0;flips=0;
  flipsEl.textContent=0;

  cards.forEach(img=>{
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=`
      <div class="inner">
        <div class="face front"></div>
        <div class="face back" style="background-image:url(${img})"></div>
      </div>`;
    c.onclick=()=>flip(c,img);
    grid.appendChild(c);
  });
}
start();

function flip(card,img){
  if(lock||card.classList.contains("open"))return;
  card.classList.add("open");
  flips++;flipsEl.textContent=flips;

  if(!first){first={card,img};return;}

  if(first.img===img){
    matched++;first=null;
    if(matched===images.length){
      let best=Number(localStorage.getItem("best"));
      if(best===0||flips<best){
        localStorage.setItem("best",flips);
        bestEl.textContent=flips;
      }
    }
  }else{
    lock=true;
    setTimeout(()=>{
      card.classList.remove("open");
      first.card.classList.remove("open");
      first=null;
      lock=false;
    },800);
  }
}

function resetGame(){start();}

function goHome(){
  localStorage.setItem("musicTime",music.currentTime);
  window.location.href="index.html";
}
</script>

</body>
</html>
